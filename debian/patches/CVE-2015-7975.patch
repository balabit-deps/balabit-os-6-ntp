From 12f1323d18c8d74eb14fb5ac5574183d779794c5 Mon Sep 17 00:00:00 2001
From:  <jnperlin@hydra.localnet>
Date: Sun, 11 Oct 2015 09:32:40 +0200
Subject: [PATCH] [Bug 2937] (NTPQ) nextvar() missing length check

---
 ChangeLog   | 2 ++
 ntpq/ntpq.c | 2 ++
 2 files changed, 4 insertions(+)

diff --git a/ntpq/ntpq.c b/ntpq/ntpq.c
index 17fe2ea..ce3a49b 100644
--- a/ntpq/ntpq.c
+++ b/ntpq/ntpq.c
@@ -2950,6 +2950,8 @@ nextvar(
 	len = srclen;
 	while (len > 0 && isspace((unsigned char)cp[len - 1]))
 		len--;
+	if (len >= sizeof(name))
+	    return 0;
 	if (len > 0)
 		memcpy(name, cp, len);
 	name[len] = '\0';
