Description: fix incorrect initial sync calculations
Origin: vendor, https://git.centos.org/blob/rpms!ntp.git/4eb1db127a6177011bd913bf4f446e8f701179d6/SOURCES!ntp-4.2.6p5-cve-2016-7433.patch
Bug: http://bugs.ntp.org/show_bug.cgi?id=2085

Index: ntp-4.2.8p4+dfsg/ntpd/ntp_proto.c
===================================================================
--- ntp-4.2.8p4+dfsg.orig/ntpd/ntp_proto.c	2017-06-28 11:43:51.801705923 -0400
+++ ntp-4.2.8p4+dfsg/ntpd/ntp_proto.c	2017-06-28 11:43:51.801705923 -0400
@@ -3176,8 +3176,7 @@ root_distance(
 	 * where:
 	 *  delta   is the round-trip delay
 	 *  DELTA   is the root delay
-	 *  epsilon is the remote server precision + local precision
-	 *	    + (15 usec each second)
+	 *  epsilon is the peer dispersion (15 usec each second)
 	 *  EPSILON is the root dispersion
 	 *  phi     is the peer jitter statistic
 	 *
@@ -3188,8 +3187,7 @@ root_distance(
 	 * other worse choices.
 	 */
 	dtemp = (peer->delay + peer->rootdelay) / 2
-		+ LOGTOD(peer->precision)
-		  + LOGTOD(sys_precision)
+		+ peer->disp
 		  + clock_phi * (current_time - peer->update)
 		+ peer->rootdisp
 		+ peer->jitter;
