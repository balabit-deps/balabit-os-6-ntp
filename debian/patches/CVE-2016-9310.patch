

    TOPntp-stable1.3686.17.1 changes

NTP - Network Time Protocol
#### ChangeSet ####

2016-09-24 20:38:17+02:00, perlinger@ntp.org
  [Sec 3118] Mode 6 information disclosure and DDoS vector

#==== ChangeLog ====
#
#2016-09-24 20:38:17+02:00, perlinger@ntp.org +4 -0
#  [Sec 3118] Mode 6 information disclosure and DDoS vector
#--- 1.1834/ChangeLog	2016-06-02 11:39:59 +00:00
#+++ 1.1834.17.1/ChangeLog	2016-09-24 18:38:17 +00:00
#@@ -1,3 +1,7 @@
#+---
#+* [Sec 3118] Mode 6 information disclosure and DDoS vector <perlinger@ntp.org>
#+  - TRAP config via mode 6 packet requires AUTH now.
#+
# ---
# (4.2.8p8) 2016/06/02 Released by Harlan Stenn <stenn@ntp.org>
# 
#
#==== ntpd/ntp_control.c ====
#
#2016-09-24 20:38:17+02:00, perlinger@ntp.org +3 -3
#  [Sec 3118] Mode 6 information disclosure and DDoS vector
#   - TRAP config via mode 6 packet requires AUTH now
#   - writing the clock status should require AUTH, too.
--- 1.209/ntpd/ntp_control.c	2016-02-22 06:34:05 +00:00
+++ 1.209.5.1/ntpd/ntp_control.c	2016-09-24 18:38:17 +00:00
@@ -120,14 +120,14 @@ static const struct ctl_proc control_cod
 	{ CTL_OP_READVAR,		NOAUTH,	read_variables },
 	{ CTL_OP_WRITEVAR,		AUTH,	write_variables },
 	{ CTL_OP_READCLOCK,		NOAUTH,	read_clockstatus },
-	{ CTL_OP_WRITECLOCK,		NOAUTH,	write_clockstatus },
-	{ CTL_OP_SETTRAP,		NOAUTH,	set_trap },
+	{ CTL_OP_WRITECLOCK,		AUTH,	write_clockstatus },
+	{ CTL_OP_SETTRAP,		AUTH,	set_trap },
 	{ CTL_OP_CONFIGURE,		AUTH,	configure },
 	{ CTL_OP_SAVECONFIG,		AUTH,	save_config },
 	{ CTL_OP_READ_MRU,		NOAUTH,	read_mru_list },
 	{ CTL_OP_READ_ORDLIST_A,	AUTH,	read_ordlist },
 	{ CTL_OP_REQ_NONCE,		NOAUTH,	req_nonce },
-	{ CTL_OP_UNSETTRAP,		NOAUTH,	unset_trap },
+	{ CTL_OP_UNSETTRAP,		AUTH,	unset_trap },
 	{ NO_REQUEST,			0,	NULL }
 };
 


