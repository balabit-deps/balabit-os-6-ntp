

    TOPntp-stable1.3720.8.1 changes

NTP - Network Time Protocol
#### ChangeSet ####

2016-12-30 10:39:31+01:00, jnperlin@hydra.localnet
  [Bug 3356] Bugfix 3072 breaks multicastclient

#==== ChangeLog ====
#
#2016-12-30 10:39:31+01:00, jnperlin@hydra.localnet +3 -0
#  [Bug 3356] Bugfix 3072 breaks multicastclient
#--- 1.1852/ChangeLog	2016-11-21 13:08:15 +00:00
#+++ 1.1852.8.1/ChangeLog	2016-12-30 09:39:31 +00:00
#@@ -1,3 +1,6 @@
#+---
#+* [Bug 3356] Bugfix 3072 breaks multicastclient <perlinger@ntp.org>
#+
# ---
# (4.2.8p9) 2016/11/21 Released by Harlan Stenn <stenn@ntp.org>
# (4.2.8p9) 2016/MM/DD Released by Harlan Stenn <stenn@ntp.org>
#
#==== ntpd/ntp_peer.c ====
#
#2016-12-30 10:39:31+01:00, jnperlin@hydra.localnet +2 -1
#  [Bug 3356] Bugfix 3072 breaks multicastclient
#   (see bugs.ntp.org for details)
--- 1.160/ntpd/ntp_peer.c	2016-10-01 08:28:25 +00:00
+++ 1.161/ntpd/ntp_peer.c	2016-12-30 09:39:31 +00:00
@@ -309,7 +309,8 @@ findpeer(
 	for (p = peer_hash[hash]; p != NULL; p = p->adr_link) {
 
 		/* [Bug 3072] ensure interface of peer matches */
-		if (p->dstadr != rbufp->dstadr)
+		/* [Bug 3356] ... if NOT a broadcast peer!     */
+		if (p->hmode != MODE_BCLIENT && p->dstadr != rbufp->dstadr)
 			continue;
 
 		/* ensure peer source address matches */


