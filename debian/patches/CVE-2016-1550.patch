Description: fix buffer comparison timing attacks
Origin: vendor, http://pkgs.fedoraproject.org/cgit/rpms/ntp.git/tree/ntp-4.2.6p5-cve-2016-1550.patch
Bug: http://support.ntp.org/bin/view/Main/NtpBug2879

Index: ntp-4.2.8p4+dfsg/libntp/a_md5encrypt.c
===================================================================
--- ntp-4.2.8p4+dfsg.orig/libntp/a_md5encrypt.c	2016-05-31 13:52:52.341727600 -0400
+++ ntp-4.2.8p4+dfsg/libntp/a_md5encrypt.c	2016-05-31 13:53:16.146029381 -0400
@@ -92,7 +92,7 @@
 		    "MAC decrypt: MAC length error");
 		return (0);
 	}
-	return !memcmp(digest, (char *)pkt + length + 4, len);
+	return (!CRYPTO_memcmp(digest, (char *)pkt + length + 4, len));
 }
 
 /*
Index: ntp-4.2.8p4+dfsg/sntp/crypto.c
===================================================================
--- ntp-4.2.8p4+dfsg.orig/sntp/crypto.c	2016-05-31 13:52:52.341727600 -0400
+++ ntp-4.2.8p4+dfsg/sntp/crypto.c	2016-05-31 13:52:52.337727549 -0400
@@ -58,7 +58,7 @@
 	if (!hash_len)
 		authentic = FALSE;
 	else
-		authentic = !memcmp(digest, pkt_data + pkt_size + 4,
+		authentic = !CRYPTO_memcmp(digest, pkt_data + pkt_size + 4,
 				    hash_len);
 	return authentic;
 }
